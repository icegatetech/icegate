# Query Binary Configuration Example
#
# Copy this file to config.query.yaml and adjust the values for your environment.

# Catalog Configuration
catalog:
  # Catalog backend options:
  # - !memory (for testing)
  # - !rest { uri: "http://127.0.0.1:19120/iceberg" }
  # - !s3tables { table_bucket_arn: "arn:aws:s3tables:us-east-1:123456789012:bucket/my-bucket" }
  # - !glue {}
  # - !glue { catalog_id: "123456789012" }
  backend: !rest
    uri: http://127.0.0.1:19120/iceberg
  # Warehouse location (root path for data storage)
  warehouse: s3://warehouse
  # Additional catalog properties (optional)
  properties:
    prefix: main
  # IO cache for FileIO reads (optional).
  # When enabled, wraps Iceberg FileIO with a foyer hybrid cache
  # (memory + disk) to reduce S3 round-trips for repeated reads.
  # cache:
  #   memory_size_mb: 64          # Memory cache capacity in MiB
  #   disk_dir: /tmp/icegate/cache # Directory for disk cache storage
  #   disk_size_mb: 256           # Disk cache capacity in MiB

# Storage Configuration
storage:
  # Storage backend options:
  # - !memory (for testing)
  # - !filesystem { root_path: "/var/lib/icegate/data" }
  # - !s3 { bucket: "warehouse", region: "us-east-1", endpoint: "https://..." }
  backend: !s3
    bucket: warehouse
    region: us-east-1
    endpoint: https://127.0.0.1:9100
  # Storage properties (optional)
  properties: {}

# Loki API Server (LogQL queries)
loki:
  enabled: true
  host: 127.0.0.1
  port: 3100

# Prometheus API Server (PromQL queries)
prometheus:
  enabled: true
  host: 127.0.0.1
  port: 9090

# Tempo API Server (TraceQL queries)
tempo:
  enabled: true
  host: 127.0.0.1
  port: 3200

# Query Engine Configuration
engine:
  # WAL base path for near-real-time queries (required)
  wal_base_path: s3://queue/
  # batch_size: 8192                   # DataFusion batch size (optional)
  # target_partitions: 4               # Parallelism degree (optional)
  # catalog_name: iceberg              # Catalog name in SQL queries (optional)
